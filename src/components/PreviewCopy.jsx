import { useState } from 'react'

import { useCopyToClipboard } from 'react-use'

import ButtonStyle from '@component/ButtonStyle'

export default function PreviewCopy({ codeType, componentCode = '' }) {
  const [buttonText, setButtonText] = useState('Copy')
  const [buttonEmoji, setButtonEmoji] = useState('ðŸ“‹')
  const [copyStatus, copyToClipboard] = useCopyToClipboard()

  const buttonActive = buttonText === 'Copied'

  const codeTypeMap = {
    html: 'HTML',
    jsx: 'JSX',
    vue: 'Vue',
  }

  const codeTypeLabel = codeTypeMap[codeType]

  function handleCopyToClipboard() {
    copyToClipboard(componentCode)

    if (copyStatus.error) {
      setButtonText('Error')
      setButtonEmoji('ðŸš¨')

      return
    }

    setButtonText('Copied')
    setButtonEmoji('ðŸŽ‰')

    setTimeout(() => {
      setButtonText('Copy')
      setButtonEmoji('ðŸ“‹')
    }, 3000)
  }

  return (
    <button className="hidden sm:block" onClick={handleCopyToClipboard}>
      <ButtonStyle
        buttonEmoji={buttonEmoji}
        buttonText={`${buttonText} ${codeTypeLabel}`}
        buttonActive={buttonActive}
      />
    </button>
  )
}
